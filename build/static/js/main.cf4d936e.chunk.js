(this.webpackJsonplintubongari=this.webpackJsonplintubongari||[]).push([[0],{54:function(t,e,n){},60:function(t,e,n){"use strict";n.r(e);var a=n(28),i=n.n(a),c=n(5),r=n.n(c),s=n(11),u=n(3),o=n(1),l=n.n(o),j=n(14),d=n(2),b=n(9),h=n.n(b),O="/api/lintudb/havainto",v="/api/lintudb/lintu",p="/api/lintudb/user",x=null,f=function(){var t=Object(s.a)(r.a.mark((function t(e){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a.get("/api/wiki?haku="+e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),g={getAll:function(){return h.a.get("/api/lintudb/").then((function(t){return t.data}))},getHavainto:function(){return h.a.get(O).then((function(t){return t.data}))},getLintu:function(){return h.a.get(v).then((function(t){return t.data}))},getUser:function(){return h.a.get(p).then((function(t){return t.data}))},createUser:function(){var t=Object(s.a)(r.a.mark((function t(e){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a.post(p,e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),createHavainto:function(){var t=Object(s.a)(r.a.mark((function t(e){var n,a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={headers:{Authorization:x}},t.next=3,h.a.post(O,e,n);case 3:return a=t.sent,t.abrupt("return",a.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),createLintu:function(){var t=Object(s.a)(r.a.mark((function t(e){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a.post(v,e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),updateHavainto:function(t,e){return h.a.put("".concat(O,"/").concat(t),e).then((function(t){return t.data}))},removeHavainto:function(t){return h.a.delete("".concat(O,"/").concat(t)).then((function(t){return t.data}))},setToken:function(t){x="bearer ".concat(t)},getWikiHaku:f},m=n(0),k=l.a.forwardRef((function(t,e){var n=Object(o.useState)(!1),a=Object(u.a)(n,2),i=a[0],c=a[1],r={display:i?"none":""},s={display:i?"":"none"},l=function(){c(!i)};return Object(o.useImperativeHandle)(e,(function(){return{toggleVisibility:l}})),Object(m.jsxs)("div",{children:[Object(m.jsxs)("div",{style:s,children:[t.children,Object(m.jsx)("button",{className:"btn",onClick:l,children:"Peruuta"})]}),Object(m.jsx)("div",{style:r,children:Object(m.jsx)("button",{className:"btn",onClick:l,children:t.buttonLabel})})]})})),w=function(t){var e=t.user,n=t.changeHavainto,a=t.havaintoList,i=t.deleteHavainto,c=t.printHavainto,r=t.changedmaara,s=t.handleUpdateMaaraChange,u=t.changedkunta,o=t.handleUpdateKuntaChange,l=t.changedpaikka,j=t.handleUpdatePaikkaChange,d=t.changedlisatiedot,b=t.handleUpdateTiedotChange,h=function(t){var e=t.subject,n=t.value,a=t.onChange;return Object(m.jsxs)("tr",{children:[Object(m.jsx)("td",{children:e}),Object(m.jsx)("td",{children:Object(m.jsx)("input",{value:n,onChange:a})})]})};return Object(m.jsxs)("div",{className:"havainnot",children:[Object(m.jsx)("h2",{children:" Havainnot "}),Object(m.jsx)("ul",{children:a.map((function(t){return Object(m.jsx)("li",{children:Object(m.jsxs)("div",{id:t.id,className:"havainto",children:[Object(m.jsxs)("h3",{children:["Laji: ",t.laji]}),Object(m.jsxs)("p",{children:[" M\xe4\xe4r\xe4: ",t.maara]}),Object(m.jsxs)("p",{children:[" ","Paikkakunta: ",t.kunta," ",Object(m.jsx)("br",{}),"Paikka: ",t.paikka,Object(m.jsx)("br",{}),"Lis\xe4tiedot: ",t.lisatiedot]}),Object(m.jsxs)("p",{children:["Havainnoija: ",t.user.username]}),Object(m.jsxs)("div",{children:[" ",null!==e?Object(m.jsxs)("div",{children:[Object(m.jsx)(k,{buttonLabel:"Muokkaa havaintoa",children:Object(m.jsxs)("div",{children:[Object(m.jsx)("h4",{children:"P\xe4ivit\xe4 havainto"}),Object(m.jsxs)("form",{className:"changeForm",children:[Object(m.jsx)("table",{children:Object(m.jsxs)("tbody",{children:[h({subject:"M\xe4\xe4r\xe4:",changedmaara:r,handleUpdateMaaraChange:s}),h({subject:"Kunta:",changedkunta:u,handleUpdateKuntaChange:o}),h({subject:"Paika:",changedpaikka:l,handleUpdatePaikkaChange:j}),h({subject:"Lis\xe4tiedot:",changedlisatiedot:d,handleUpdateTiedotChange:b})]})}),Object(m.jsx)("br",{}),Object(m.jsx)("button",{type:"submit",className:"btn",onClick:function(){return n(t.id)},children:"Tallenna"}),Object(m.jsx)("button",{type:"reset",className:"btn",children:"Tyhjenn\xe4"})]})]})}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("button",{className:"btn",onClick:function(){return i(t)},children:"Poista havainto"}),Object(m.jsx)("input",{type:"button",className:"btn",onClick:function(){return c(t.id)},value:"Tulosta havainto"})," "]}):Object(m.jsx)("div",{})]})]})},t.id)}))})]})},y={login:function(){var t=Object(s.a)(r.a.mark((function t(e){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a.post("/api/login",e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},L=function(t){var e=t.lintuList,n=function(t){return Object(m.jsxs)("div",{className:"lintu",children:[Object(m.jsxs)("h3",{children:["Laji: ",t.laji]}),Object(m.jsxs)("p",{children:["Tieteellinen nimi: ",t.tieteellinenNimi]}),Object(m.jsx)("img",{src:t.kuvaWikipediastaAPI,className:"img",alt:t.laji}),Object(m.jsxs)("p",{children:["Lahko: ",t.lahko," ",Object(m.jsx)("br",{}),"Heimo: ",t.heimo," ",Object(m.jsx)("br",{}),"Suku: ",t.suku]}),Object(m.jsxs)("p",{children:["Elinvoimaisuus: ",t.elinvoimaisuus]})]})};return Object(m.jsx)("div",{className:"lintutaulu",children:e.map((function(t,e){return Object(m.jsx)("div",{children:n(t)},e)}))})},N=(n(54),function(){var t=Object(o.useState)([]),e=Object(u.a)(t,2),n=e[0],a=e[1],i=Object(o.useState)([]),c=Object(u.a)(i,2),l=c[0],b=c[1],h=Object(o.useState)([]),O=Object(u.a)(h,2),v=O[0],p=O[1],x=Object(o.useState)(""),f=Object(u.a)(x,2),N=f[0],S=f[1],C=Object(o.useState)(""),H=Object(u.a)(C,2),U=H[0],P=H[1],T=Object(o.useState)(""),M=Object(u.a)(T,2),I=M[0],K=M[1],E=Object(o.useState)(""),z=Object(u.a)(E,2),R=z[0],A=z[1],D=Object(o.useState)(""),J=Object(u.a)(D,2),W=J[0],B=J[1],F=Object(o.useState)(""),V=Object(u.a)(F,2),_=V[0],q=V[1],G=Object(o.useState)(""),Q=Object(u.a)(G,2),X=Q[0],Y=Q[1],Z=Object(o.useState)(""),$=Object(u.a)(Z,2),tt=$[0],et=$[1],nt=Object(o.useState)(""),at=Object(u.a)(nt,2),it=at[0],ct=at[1],rt=Object(o.useState)(null),st=Object(u.a)(rt,2),ut=st[0],ot=st[1],lt=Object(o.useState)(""),jt=Object(u.a)(lt,2),dt=jt[0],bt=jt[1],ht=Object(o.useState)(""),Ot=Object(u.a)(ht,2),vt=Ot[0],pt=Ot[1],xt=Object(o.useState)(""),ft=Object(u.a)(xt,2),gt=ft[0],mt=ft[1],kt=Object(o.useState)(""),wt=Object(u.a)(kt,2),yt=wt[0],Lt=wt[1],Nt=Object(o.useState)({}),St=Object(u.a)(Nt,2),Ct=St[0],Ht=St[1];Object(o.useEffect)((function(){g.getHavainto().then((function(t){a(t)}))}),[]),Object(o.useEffect)((function(){g.getLintu().then((function(t){b(t)}))}),[]),Object(o.useEffect)((function(){g.getUser().then((function(t){p(t)}))}),[]),Object(o.useEffect)((function(){var t=window.localStorage.getItem("loggedLintupongariUser");if(t){var e=JSON.parse(t);ot(e),g.setToken(e.token)}}),[]),Object(o.useEffect)((function(){N?g.getWikiHaku(N).then((function(t){Ht(t)})).catch((function(t){alert(t),console.log(t)})):console.log("No data yet")}),[N]);var Ut=function(t){t.preventDefault();var e={laji:N,maara:U,kunta:I,paikka:R,lisatiedot:W,user:ut.username};if(l.some((function(t){return t.laji.toLowerCase()===N.toLowerCase()})))window.alert(N+" on jo lintutaulussa.");else{var i,c,r,s,u,o,j=null===Ct||void 0===Ct||null===(i=Ct[0])||void 0===i||null===(c=i.cirrusdoc)||void 0===c||null===(r=c[0].source)||void 0===r?void 0:r.auxiliary_text[0],d=j.split("Lahko: ")[1].split(" "),h=j.split("Heimo: ")[1].split(" "),O=j.split("Suku: ")[1].split(" "),v=j.split("Uhanalaisuusluokitus ")[1].split(" "),p=j.split("Kaksiosainen nimi ")[1].split(" "),x={laji:null===Ct||void 0===Ct||null===(s=Ct[0])||void 0===s?void 0:s.title,tieteellinenNimi:"".concat(p[0]," ").concat(p[1]),kuvaWikipediastaAPI:null===Ct||void 0===Ct||null===(u=Ct[0])||void 0===u||null===(o=u.original)||void 0===o?void 0:o.source,lahko:"".concat(d[0]," ").concat(d[1]),heimo:"".concat(h[0]," ").concat(h[1]),suku:"".concat(O[0]," ").concat(O[1]),elinvoimaisuus:v[0]};g.createLintu(x).then((function(t){b(l.concat(t)),Ht(""),console.log(l)}))}g.createHavainto(e).then((function(t){a(n.concat(t)),S(""),P(""),K(""),A(""),B("")}))},Pt=function(t){S(t.target.value)},Tt=function(t){P(t.target.value)},Mt=function(t){K(t.target.value)},It=function(t){A(t.target.value)},Kt=function(t){B(t.target.value)},Et=function(t){et(t.target.value)},zt=function(t){ct(t.target.value)},Rt=function(){var t=Object(s.a)(r.a.mark((function t(e){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),t.prev=1,t.next=4,y.login({username:_,password:X});case 4:n=t.sent,window.localStorage.setItem("loggedLintupongariUser",JSON.stringify(n)),g.setToken(n.token),ot(n),q(""),Y(""),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e){return t.apply(this,arguments)}}(),At=function(){var t=Object(s.a)(r.a.mark((function t(e){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.preventDefault(),window.localStorage.removeItem("loggedLintupongariUser"),ot(null);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Dt=function(t){t.preventDefault();var e={username:tt,password:it};g.createUser(e).then((function(t){p(v.concat(t))})),window.alert("Tervetuloa "+tt),et(""),ct("")};return Object(m.jsx)("div",{children:Object(m.jsx)("div",{children:Object(m.jsx)(j.a,{children:Object(m.jsxs)("div",{children:[Object(m.jsxs)("ul",{className:"links",children:[Object(m.jsx)("li",{children:Object(m.jsx)(j.b,{to:"/havainnot",children:"Havainnot"})}),Object(m.jsx)("li",{children:Object(m.jsx)(j.b,{to:"/linnut",children:"Linnut"})}),Object(m.jsx)("h1",{children:"Lintupongari"})]}),Object(m.jsxs)("div",{className:"content",children:[Object(m.jsxs)("div",{className:"toggleBox",children:[null===ut?Object(m.jsxs)("div",{className:"loginLaatikko",children:[Object(m.jsx)("h2",{children:"Kirjaudu sis\xe4\xe4n"}),Object(m.jsxs)("form",{onSubmit:Rt,children:[Object(m.jsxs)("div",{children:[Object(m.jsx)("p",{children:"K\xe4ytt\xe4j\xe4tunnus: "}),Object(m.jsx)("input",{type:"text",size:"15",value:_,name:"Username",onChange:function(t){var e=t.target;return q(e.value)}})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("p",{children:"Salasana: "}),Object(m.jsx)("input",{type:"password",size:"15",value:X,name:"Password",onChange:function(t){var e=t.target;return Y(e.value)}})]}),Object(m.jsx)("p",{children:Object(m.jsx)("button",{className:"btn",type:"submit",children:"Kirjaudu"})})]})]}):Object(m.jsxs)("div",{children:[Object(m.jsxs)("p",{className:"newSighting",children:["Logged in as: ",Object(m.jsx)("br",{})," ",ut.username,Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("button",{className:"btn",onClick:At,children:"Log out"})," "]}),Object(m.jsx)("br",{}),Object(m.jsxs)("div",{className:"newSighting",children:[Object(m.jsx)("h4",{children:"Lis\xe4\xe4 uusi havainto:"}),Object(m.jsxs)("form",{onSubmit:Ut,className:"lintuform",children:[Object(m.jsxs)("div",{children:["Laji: ",Object(m.jsx)("input",{value:N,onChange:Pt})]}),Object(m.jsxs)("div",{children:["M\xe4\xe4r\xe4: ",Object(m.jsx)("input",{value:U,onChange:Tt})]}),Object(m.jsxs)("div",{children:["Kunta: ",Object(m.jsx)("input",{value:I,onChange:Mt})]}),Object(m.jsxs)("div",{children:["Paikka: ",Object(m.jsx)("input",{value:R,onChange:It})]}),Object(m.jsxs)("div",{children:["Lis\xe4tiedot: ",Object(m.jsx)("input",{value:W,onChange:Kt})]}),Object(m.jsx)("br",{}),Object(m.jsx)("button",{className:"btn",type:"submit",children:"Tallenna"}),Object(m.jsx)("button",{className:"btn",type:"reset",children:"Tyhjenn\xe4"})]})]})]}),Object(m.jsx)("div",{children:null===ut?Object(m.jsx)(k,{buttonLabel:"Rekister\xf6idy",children:Object(m.jsxs)("div",{className:"loginLaatikko",children:[Object(m.jsx)("h2",{children:"Rekister\xf6i k\xe4ytt\xe4j\xe4tunnus"}),Object(m.jsxs)("form",{onSubmit:Dt,children:[Object(m.jsxs)("label",{children:[Object(m.jsx)("p",{children:"M\xe4\xe4rit\xe4 k\xe4ytt\xe4j\xe4tunnus:"}),Object(m.jsx)("input",{type:"text",size:"15",value:tt,onChange:Et})]}),Object(m.jsxs)("label",{children:[Object(m.jsx)("p",{children:"M\xe4\xe4rit\xe4 salasana:"}),Object(m.jsx)("input",{type:"password",size:"15",value:it,onChange:zt})]}),Object(m.jsx)("div",{children:Object(m.jsx)("p",{children:Object(m.jsx)("button",{className:"btn",type:"submit",children:"Rekister\xf6idy"})})})]})]})}):Object(m.jsx)("div",{})})]}),Object(m.jsx)(d.a,{path:"/havainnot",children:Object(m.jsx)(w,{user:ut,changeHavainto:function(t){var e=n.find((function(e){return e.id===t}));console.log(e.laji);var i={laji:e.laji,maara:dt,kunta:vt,paikka:gt,lisatiedot:yt};g.updateHavainto(t,i).then((function(e){a(n.map((function(n){return n.id!==t?n:e}))),bt(""),pt(""),mt(""),Lt("")}))},havaintoList:n,deleteHavainto:function(t){window.confirm("Poista "+t.laji+"?")&&g.removeHavainto(t.id).then((function(e){a(n.filter((function(e){return e.id!==t.id})))}))},printHavainto:function(t){var e=window.open("","PRINT","height=400,width=600");return e.document.write("<html><head><title>"+document.title+"</title>"),e.document.write("</head><body >"),e.document.write("<h1>"+document.title+"</h1>"),e.document.write(document.getElementById(t).innerHTML),e.document.write("</body></html>"),e.document.close(),e.focus(),e.print(),!0},changedmaara:dt,handleUpdateMaaraChange:function(t){bt(t.target.value)},changedkunta:vt,handleUpdateKuntaChange:function(t){pt(t.target.value)},changedpaikka:gt,handleUpdatePaikkaChange:function(t){mt(t.target.value)},changedlisatiedot:yt,handleUpdateTiedotChange:function(t){Lt(t.target.value)}})}),Object(m.jsxs)(d.a,{path:"/linnut",children:[Object(m.jsx)("h2",{className:"lintuOtsikko",children:" Lintutaulu "}),Object(m.jsx)(L,{lintuList:l})]})]})]})})})})});i.a.render(Object(m.jsx)(N,{}),document.getElementById("root"))}},[[60,1,2]]]);
//# sourceMappingURL=main.cf4d936e.chunk.js.map